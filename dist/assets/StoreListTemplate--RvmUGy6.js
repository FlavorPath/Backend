import{e as p,q as w,u as N,j as s,c,h as T,r as g}from "./index-DXBLHHrj.js";import{f as h,c as B}from "./float-sWumIdEC.js";import{I as _}from "./Icon-CjOVr4Uv.js";import{a as f}from "./index-CfgCCQ2r.js";import{u as b}from "./useQuery-6Uqetumk.js";import{u as C}from "./index-yo3Ex1nr.js";import{c as k}from "./react-B2qnJnne.js";const R=async()=>(await f.get("/scrap")).data.data,V=async e=>(await f.post("/scrap",{restaurantId:e})).data,q=()=>{const t=p().pathname==="/bookmarks";return b({queryKey:["get-bookmarks"],queryFn:R,enabled:!!t})},I=()=>C({mutationFn:({restaurantId:e})=>V(e),onSuccess:()=>{w.invalidateQueries({queryKey:["get-bookmarks"]})}}),L=()=>{const e=N(),o=p().pathname==="/search",{mutate:a}=I();return{isSearching:o,deleteBookmark:a,onClick: r=>{e(o?`/restaurant/${r.id}`:`/restaurant/${r.restaurantId}`)}}},O=({searchText:e,...t})=>{const{isSearching:o,deleteBookmark:a,onClick:n}=L();return s.jsxs("div",{className:i.container,children:[s.jsxs("a",{className:h({width:"100%"}),onClick:()=>n(t),children:[s.jsx("div",{className:i.store_img,children:s.jsx("img",{src:t.photo_url,alt:"store img",className:i.photo,loading:"lazy"})}),s.jsxs("div",{className:i.info_box,children:[s.jsx("div",{className:h({marginTop:"2px",gap:"4px"}),children:t.labels.map((r, l)=>s.jsxs("span",{className:T(i.keyword,c({color:e===r?"primary.main":"background.gray"})),children:[r,l!==t.labels.length-1?",":""]},r))}),s.jsx("strong",{className:i.title,children:t.name}),s.jsx("span",{className:i.address,children:t.address})]})]}),!o&&s.jsx("div",{className:i.bookmark,onClick:()=>a({restaurantId:t.restaurantId}),children:s.jsx("span",{className:i.solid_icon,children:s.jsx(_,{library:"hero-solid",iconName:"BookmarkIcon"})})})]})},i={container:h({width:"100%",padding:"30px 30px",position:"relative",borderBottomColor:"background.lightgray",borderBottomWidth:"1px",borderBottomStyle:"solid"}),store_img:c({width:"65px",height:"65px",borderRadius:"8px",overflow:"hidden"}),info_box:h({flexDirection:"column",marginLeft:"8px",flex:1}),keyword:c({textStyle:"caption1"}),title:c({marginTop:"10px",fontSize:"18px",fontWeight:"bold"}),address:c({marginTop:"8px",textStyle:"caption1",fontWeight:"light",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"245px",maxHeight:"12px"}),bookmark:c({position:"absolute",right:"30px",width:"20px",height:"24px"}),outlined_icon:c({"& > button > svg":{fill:"white",stroke:"primary.main",strokeWidth:"2"}}),solid_icon:c({"& > button > svg":{fill:"primary.main"}}),photo:c({width:"100%",height:"inherit",objectFit:"cover"})},D=async(e, t)=>{const o=`/search?toggle=${t?"label":"name"}&query=${encodeURIComponent(e)}`;return(await f.get(o)).data.data},W=({searchText:e,isToggleOn:t})=>{const a=p().pathname==="/search";return b({queryKey:["search-store",t?"label":"name",e],queryFn:()=>D(e,t),enabled:!!a&&!!e})},$=k(e=>({searchValue:"",setSearchValue: t=>e({searchValue:t})})),E=k(e=>({stores:[],setStores: t=>e({stores:t}),noResultText:"",setNoResultText: t=>e({noResultText:t})})),F=k(e=>({isOn:!1,toggle:()=>e(t=>({isOn:!t.isOn})),setDefaultValue: t=>e({isOn:t})})),P=(e, t)=>{const[o,a]=g.useState(e);return g.useEffect(()=>{const n=setTimeout(()=>{a(e)},t);return()=>{clearTimeout(n)}},[e,t]),o},G=()=>{const{pathname:e}=p(),t=e==="/search",o=e==="/bookmarks",{stores:a,noResultText:n,setStores:r,setNoResultText:l}=E(),{searchValue:d,setSearchValue:y}=$(),S=F(m=>m.isOn),{data:u}=q(),j=P(d,150),{data:x,isLoading:v}=W({searchText:j,isToggleOn:S});return g.useEffect(()=>{if(t){if(!d){r([]),l("검색어를 입력해 주세요!");return}x&&(r(x),l("검색 결과가 없습니다."))}else o&&(u!=null&&u.length?r(u.map(m=>({...m,photo_url:m.photos[0],isBookmarked:!0}))):r([]),l("스크랩된 스토어가 없습니다."))},[t,o,x,u,d]),{stores:a,noResultText:n,isToggleOn:S,searchValue:d,setSearchValue:y,isSearchLoading:v}},X=()=>{const{stores:e,noResultText:t,searchValue:o,isSearchLoading:a}=G();return s.jsxs("div",{children:[e&&(e==null?void 0:e.map(n=>s.jsx(O,{...n,searchText:o},n.name))),!(e!=null&&e.length)&&!a&&s.jsx("div",{className:H.no_result,children:t})]})},H={no_result:B({textStyle:"body3",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"})};export{X as S,G as a,F as u};
